// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var List = require("bs-platform/lib/js/list.js");
var $$Array = require("bs-platform/lib/js/array.js");
var Belt_Option = require("bs-platform/lib/js/belt_Option.js");
var DynamicRequire = require("./dynamicRequire");

function dynReq(prim) {
  return DynamicRequire.default(prim);
}

function loadModule(path) {
  return DynamicRequire.default(path).default;
}

function projectConfig(projectSlug, configPath) {
  var path = Belt_Option.getWithDefault(configPath, process.env.HOME + "/.branch-name");
  var config = DynamicRequire.default(path).default;
  var projects = $$Array.to_list(config.projects);
  try {
    return {
            TAG: /* Ok */0,
            _0: List.find((function (p) {
                    return p.slug === projectSlug;
                  }), projects)
          };
  }
  catch (exn){
    return {
            TAG: /* Error */1,
            _0: "unknown project " + projectSlug
          };
  }
}

function server(projectConfig) {
  var match = projectConfig.server;
  switch (match) {
    case "clubhouse" :
        var authToken = projectConfig.serverConfig.authToken;
        if (authToken !== undefined) {
          return {
                  TAG: /* Ok */0,
                  _0: {
                    TAG: /* Clubhouse */0,
                    _0: authToken
                  }
                };
        } else {
          return {
                  TAG: /* Error */1,
                  _0: "server config missing authToken value"
                };
        }
    case "gitlab" :
        var match$1 = projectConfig.serverConfig;
        var projectId = match$1.projectId;
        var token = match$1.token;
        var host = match$1.host;
        if (host !== undefined) {
          if (token !== undefined) {
            if (projectId !== undefined) {
              return {
                      TAG: /* Ok */0,
                      _0: {
                        TAG: /* Gitlab */2,
                        _0: host,
                        _1: token,
                        _2: projectId
                      }
                    };
            } else {
              return {
                      TAG: /* Error */1,
                      _0: "server config missing projectId value"
                    };
            }
          } else if (projectId !== undefined) {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing token value"
                  };
          } else {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing token and projectId values"
                  };
          }
        } else if (token !== undefined) {
          if (projectId !== undefined) {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing host value"
                  };
          } else {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing host and projectId values"
                  };
          }
        } else if (projectId !== undefined) {
          return {
                  TAG: /* Error */1,
                  _0: "server config missing host and projectId values"
                };
        } else {
          return {
                  TAG: /* Error */1,
                  _0: "server config missing host, token and projectId values"
                };
        }
    case "jira" :
        var match$2 = projectConfig.serverConfig;
        var password = match$2.password;
        var username = match$2.username;
        var host$1 = match$2.host;
        if (host$1 !== undefined) {
          if (username !== undefined) {
            if (password !== undefined) {
              return {
                      TAG: /* Ok */0,
                      _0: {
                        TAG: /* Jira */1,
                        _0: host$1,
                        _1: username,
                        _2: password
                      }
                    };
            } else {
              return {
                      TAG: /* Error */1,
                      _0: "server config missing password value"
                    };
            }
          } else if (password !== undefined) {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing username value"
                  };
          } else {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing username and password values"
                  };
          }
        } else if (username !== undefined) {
          if (password !== undefined) {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing host value"
                  };
          } else {
            return {
                    TAG: /* Error */1,
                    _0: "server config missing host and password values"
                  };
          }
        } else if (password !== undefined) {
          return {
                  TAG: /* Error */1,
                  _0: "server config missing host and password values"
                };
        } else {
          return {
                  TAG: /* Error */1,
                  _0: "server config missing host, username and password values"
                };
        }
    default:
      return {
              TAG: /* Error */1,
              _0: "unsupported server type"
            };
  }
}

exports.dynReq = dynReq;
exports.loadModule = loadModule;
exports.projectConfig = projectConfig;
exports.server = server;
/* ./dynamicRequire Not a pure module */
